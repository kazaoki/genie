#!/usr/bin/env node
parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({3:[function(require,module,exports) {
"use strict";const e=require("fs"),r=require("string-width"),t=require("cli-color"),o=require("readline").createInterface(process.stdin,process.stdout),i=require("child_process"),s=require("path"),n=module.exports.getProjectRootDir=(()=>{let r="",t=__dirname,o=!0;do{try{e.accessSync(t+"/.genie"),r=t}catch(e){t===(t=s.dirname(t))&&(o=!1)}}while(""===r&&o);if(r)return r;h("先祖ディレクトリに .genie/ が見つかりませんでした。\n`genie init` などして初期化してください。")}),c=module.exports.Repeat=((e,r=1)=>{if(!r>0)return"";for(var t="",o=0;o<r;o++)t+=e;return t}),l=module.exports.Message=((e,o="default",i=0)=>{var s=t.white,n=t.white;e=e.replace(/[\r\n]+$/,""),"primary"===o?(s=t.xterm(26),n=t.xterm(39)):"success"===o?(s=t.green,n=t.greenBright):"danger"===o?(s=t.red,n=t.redBright):"warning"===o?(s=t.yellow,n=t.yellowBright):"info"===o&&(s=t.whiteBright,n=t.whiteBright);var l=e.split(/[\r\n]+/),a=0;for(var g in l){var p=r(l[g]);a<p&&(a=p)}for(var g in a+=2,console.log("  "+s("┏")+s(c("─",a))+s("┓")),l)i>0&&i==g&&console.log("  "+s("┣")+s(c("─",a))+s("┫")),console.log("  "+s("│")+n(" "+l[g]+" ")+c(" ",a-2-r(l[g]))+s("│"));console.log("  "+s("┗")+s(c("─",a))+s("┛"))}),a=module.exports.Input=((e,i=20)=>{var s=t.bgBlack("  "),n=r(e="  "+e+"  ")+i,l=t.whiteBright.bgBlueBright,a=t.bgBlue;return console.log("\n"+s+l(c(" ",n))+"\n"+s+l(e+c(" ",i))+"\n"+s+l(c(" ",n))+"\n"+s+a(c(" ",n))),process.stdout.write(t.move.up(3)),process.stdout.write(t.move.right(n-i)),new Promise(e=>{o.on("line",r=>{process.stdout.write(t.move.down(3)),e(r)})})}),g=module.exports.Say=(r=>{if(0!==r.length)if(d())i.execSync(`say -r 300 "${r}"`);else if(u()){let t=e.mkdtempSync(process.env.TEMP+"/genie-say-"),o=t+"/say.js";e.writeFileSync(o,"var args = [];for(var i = 0; i < WScript.Arguments.length; i++) args.push(WScript.Arguments.Item(i));WScript.CreateObject('SAPI.SpVoice').Speak('<volume level=\"100\">'+'<rate speed=\"2\">'+'<pitch middle=\"0\">'+args.join(' ')+'</pitch>'+'</rate>'+'</volume>', 8);"),i.execSync(`start wscript ${o} "${r}"`),e.unlinkSync(o),e.rmdirSync(t)}}),p=module.exports.loadConfig=(r=>{let t=`${n()}/.genie/${r.config}`;try{e.accessSync(t)}catch(e){h(`設定ファイル（.genie/${r.config}）が見つかりませんでした。`)}return require(t)}),u=module.exports.isWindows=(()=>"win32"===process.platform),d=module.exports.isMac=(()=>"darwin"===process.platform),m=module.exports.hasDockerMachineEnv=(()=>{return 0===i.spawnSync("docker-machine").status}),h=module.exports.Error=(e=>{console.log(),l(`エラーが発生しました。\n${e}`,"danger",1),process.exit()});
},{}],1:[function(require,module,exports) {
"use strict";function e(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,s){return function o(i,t){try{var r=n[i](t),a=r.value}catch(e){return void s(e)}if(!r.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});e(a)}("next")})}}const n=require("optimist"),s=require("./libs.js"),o=require("child_process"),i=require("util");let t=n.usage("Usage: genie|g [Commands] [Options]").options("mode",{alias:"m",default:"",describe:"実行モードを指定可能"}).options("config",{alias:"c",default:"config.js",describe:"設定ファイルを指定可能"}).options("help",{alias:"h",describe:"説明表示"}).argv;if("demo"===t._[0])e(function*(){console.log(),s.Message("サンプル：default","default"),s.Message("サンプル：primary","primary"),s.Message("サンプル：success","success"),s.Message("サンプル：danger","danger"),s.Message("サンプル：warning","warning"),s.Message("サンプル：info","info"),s.Message("改行込み、1ライン入れも可能。\ntest1\ntest2\ntest3","default",1);let e=yield s.Input("入力BOX（入力文字を発音しますのでご注意）：",20);s.Message("入力された文字："+e),s.Say(e);try{throw new Error("エラーテスト（終了コード255）")}catch(e){console.log(e),process.exit(255)}process.exit()})();else if("ls"===t._[0]){if(s.hasDockerMachineEnv()){console.log("\n  DockerMachine一覧");let e=o.spawnSync("docker-machine",["ls"]);s.Message(e.stdout.toString(),"primary",1)}{console.log("\n  イメージ一覧");let e=o.spawnSync("docker",["images"]);s.Message(e.stdout.toString(),"primary",1)}{console.log("\n  データボリューム一覧");let e=o.spawnSync("docker",["volume","ls"]);s.Message(e.stdout.toString(),"primary",1)}{console.log("\n  コンテナ一覧");let e=o.spawnSync("docker",["ps","-a"]);s.Message(e.stdout.toString(),"primary",1)}process.exit()}else if("config"===t._[0]){let e=n.usage("Usage: genie|g config [Options]").options("dump",{alias:"d",describe:"設定値を確認します。"}).argv;if(e.help)n.showHelp();else{let n=s.loadConfig(e);if(e.dump)console.log(i.inspect(n,{colors:!0,compact:!1,breakLength:10,depth:10}));else{let n=`${s.getProjectRootDir()}/.genie/${e.config}`;s.isWindows()?o.execSync(`start ${n}`):s.isMac()&&o.execSync(`open ${n}`)}}process.exit()}else if("clean"===t._[0]){n.usage("Usage: genie|g clean [Options]").options("locked",{alias:"l",describe:"`locked`を含むDataVolumeも削除"}).argv.help&&n.showHelp(),process.exit()}else if("langver"===t._[0]){let e=n.usage("Usage: genie|g langver [Options]").options("php",{describe:"PHPの利用可能なバージョン一覧を表示"}).options("perl",{describe:"Perlの利用可能なバージョン一覧を表示"}).options("ruby",{describe:"Rubyの利用可能なバージョン一覧を表示"}).options("node",{describe:"Node.jsの利用可能なバージョン一覧を表示"}).argv;if(e.help)n.showHelp();else if(e.php){let e=o.spawnSync("docker",["run","--rm","--entrypoint=bash","kazaoki/genie","-c","/root/.anyenv/envs/phpenv/plugins/php-build/bin/php-build --definitions"]);s.Message(e.stdout.toString(),"primary")}else if(e.perl){let e=o.spawnSync("docker",["run","--rm","--entrypoint=bash","kazaoki/genie","-c","/root/.anyenv/envs/plenv/plugins/perl-build/perl-build  --definitions"]);s.Message(e.stdout.toString(),"primary")}else if(e.ruby){let e=o.spawnSync("docker",["run","--rm","--entrypoint=bash","kazaoki/genie","-c","/root/.anyenv/envs/rbenv/plugins/ruby-build/bin/ruby-build  --definitions"]);s.Message(e.stdout.toString(),"primary")}else if(e.node){let e=o.spawnSync("docker",["run","--rm","--entrypoint=bash","kazaoki/genie","-c","/root/.anyenv/envs/ndenv/plugins/node-build/bin/node-build  --definitions"]);s.Message(e.stdout.toString(),"primary")}else n.showHelp();process.exit()}else console.error(n.help()+"\nCommands:\n  init    \n  config  設定を確認する\n  ls      Dockerコンテナ状況を確認する\n  up      \n  down    \n  update  \n  cli     \n  reject  \n  clean   \n  build   \n  langver \n  mysql   \n  psql    \n  open    \n  ngrok   \n  logs    \n  dlsync  \n  httpd   \n  spec    \n  zap     \n  demo    デモ\n"),process.exit();
},{"./libs.js":3}]},{},[1])